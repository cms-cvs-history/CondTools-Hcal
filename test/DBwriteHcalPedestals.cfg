# to write hcal pedestals into orcon/orcoff/sqlite

process ProcessOne = 
{

  service = MessageLogger 
  {
     untracked vstring destinations = {"cout"}
     untracked PSet cout = 
     {
       untracked  PSet default = { untracked int32 limit = 0 }
     }
  }

  # Empty event source
  source = EmptyIOVSource 
  {
    string timetype = "runnumber"
    untracked uint32 firstRun = 1
    untracked uint32 lastRun = 1
    uint32 interval = 1
  }


# PopCon  configuration:
  include "CondCore/PopCon/data/PopConDB.cfi"
  replace PopConDB.timetype = "runnumber"

### Uncomment the appropriate:
## to write in sqlite local file (for testing):
#  replace PopConDB.connect = "sqlite_file:DB.db"
#  replace PopConDB.DBParameters.authenticationPath="."

## to write into int2r_orcoff
#  replace PopConDB.connect = "oracle://cms_orcoff_int2r/CMS_COND_HCAL"
##  replace PopConDB.DBParameters.authenticationPath="/afs/cern.ch/user/r/rofierzy/DBauth/myorconreadonly"
##  replace PopConDB.DBParameters.authenticationPath="."    

## to write into orcon
# accounts since 17x:
#  replace PopConDB.connect = "oracle://orcon/CMS_COND_ON_170_HCAL"
#  replace PopConDB.DBParameters.authenticationPath="/afs/cern.ch/user/r/rofierzy/DBauth/myorconwrite"

### end Uncomment

### What to put:
  es_source = HcalTextCalibrations
              {
                VPSet input = 
                {{
                   string object = "Pedestals"
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_development_ped_fake.txt"     # orcon, tag hcal_pedestals_fC_gren, IOV from 0			  
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_development_ped_leveling.txt" # orcon, tag hcal_pedestals_fC_gren, IOV from 28950		  
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_ped_with29930.txt"            # orcon, tag hcal_pedestals_fC_gren, IOV from 29930		  
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_ped_with29931.txt"            # orcon, tag hcal_pedestals_fC_gren, IOV from 29931		  
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_ped_with29938.txt"            # orcon, tag hcal_pedestals_fC_gren, IOV from 29938		  
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_ped_with29970.txt"            # orcon, tag hcal_pedestals_fC_gren, IOV from 29970		  
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_ped_with29971.txt"            # orcon, tag hcal_pedestals_fC_gren, IOV from 29971		  
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_ped_with29972.txt"            # orcon, tag hcal_pedestals_fC_gren, IOV from 29972		  
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_ped_with29973.txt"            # orcon, tag hcal_pedestals_fC_gren, IOV from 29973		  
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_ped_with29979.txt"            # orcon, tag hcal_pedestals_fC_gren, IOV from 29979		  
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_ped_with29980.txt"            # orcon, tag hcal_pedestals_fC_gren, IOV from 29980		  
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_ped_with29982.txt"            # orcon, tag hcal_pedestals_fC_gren, IOV from 29982		  
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_ped_with29983.txt"            # orcon, tag hcal_pedestals_fC_gren, IOV from 29983		  
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_ped_with29984.txt"            # orcon, tag hcal_pedestals_fC_gren, IOV from 29984           	  
#                   FileInPath file = "CondFormats/HcalObjects/data/gren_ped_with30260.txt"            # orcon, tag hcal_pedestals_fC_gren, IOV from 30557		  
#                   FileInPath file = "CondFormats/HcalObjects/data/hcal_pedestals_fC_v1.txt"          # official pedestals, tag hcal_pedestals_fC_v1, orcon and orcoff	  
                   FileInPath file = "CondFormats/HcalObjects/data/hcal_pedestals_fC_v1_zdc.txt"       # official pedestals incl.ZDC, tag hcal_pedestals_fC_v1_zdc, orcoff
		 }}
              }
  es_prefer = HcalTextCalibrations{}

# Database output service - where to put
  service = PopConDBOutputService 
            {
              using PopConDB
              VPSet toPut = 
              {{ 
                 string record = "HcalPedestalsRcd" 
#                 string tag = "hcal_pedestals_fC_gren" 
#                 string tag = "hcal_pedestals_fC_v1" 
                 string tag = "hcal_pedestals_fC_v1_zdc" 
              }}
            }


  module WriteInDB = HcalPedestalsDBWriter
  {
    using PopConDB
    bool SinceAppendMode = true   # set to true when it should use sinceTime, false - uses tillTime
    bool debug = false
    string NewTagRequest = "HcalPedestalsRcd"

### IOV begin and end values to be used: if commented out, code will use beginOfTime, endOfTime by default
#    untracked uint32 startRun = 30557
#    untracked uint32 endRun = 100000
  }

  path p = {WriteInDB}
}
