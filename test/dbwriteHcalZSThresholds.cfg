# to write hcal pedestals into orcon/orcoff/sqlite

process ProcessOne = 
{

  service = MessageLogger 
  {
     untracked vstring destinations = {"cout"}
     untracked PSet cout = 
     {
       untracked  PSet default = { untracked int32 limit = 0 }
     }
  }

  # Empty event source
  source = EmptyIOVSource 
  {
    string timetype = "runnumber"
    uint64 firstValue = 1
    uint64 lastValue = 1
    uint64 interval = 1
  }

//PopCon config
include "CondCore/DBCommon/data/CondDBCommon.cfi"

### Uncomment the appropriate:
## to write in sqlite local file (for testing):
  replace CondDBCommon.connect = "sqlite_file:DB.db"
#  replace CondDBCommon.DBParameters.authenticationPath="."

## to write into int2r_orcoff
#  replace CondDBCommon.connect = "oracle://cms_orcoff_int2r/CMS_COND_HCAL"
##  replace CondDBCommon.DBParameters.authenticationPath="/afs/cern.ch/user/r/rofierzy/DBauth/myorconreadonly"
##  replace CondDBCommon.DBParameters.authenticationPath="."    

## to write into orcon
# accounts since 17x:
#  replace CondDBCommon.connect = "oracle://orcon/CMS_COND_ON_170_HCAL"
#  replace CondDBCommon.DBParameters.authenticationPath="/afs/cern.ch/user/r/rofierzy/DBauth/myorconwrite"

### end Uncomment

# source: using standard fake conditions for test:
include "CalibCalorimetry/HcalPlugins/data/Hcal_FakeConditions.cff"

# Database output service - where to put
  service = PoolDBOutputService 
            {
              using CondDBCommon
	      untracked string timetype="runnumber"
              VPSet toPut = 
              {{ 
                 string record = "HcalZSThresholdsRcd" 
                 string tag = "hcal_ZSthresholds_default" 
              }}
	      untracked string logconnect = "sqlite_file:log.db"
            }

  module WriteInDB = HcalZSThresholdsPopConAnalyzer
  {
     string record = "HcalZSThresholdsRcd"
     untracked bool loggingOn = false
     bool SinceAppendMode = true
     PSet Source = { 
     	  	     untracked uint32 IOVRun = 10
	 	   }
  }

  path p = {WriteInDB}
}